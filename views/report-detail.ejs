<%- include('partials/header') %>

<main class="main-content">
    <div class="container" style="max-width: 1000px;">
        <div style="margin-bottom: 2rem;">
            <a href="/reports" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to Reports
            </a>
        </div>

        <div class="dashboard-header">
            <h1><i class="fas fa-file-alt"></i> Report Details</h1>
            <p>Report ID: #<%= report.id %></p>
        </div>

        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; margin-bottom: 2rem;">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 2rem;">
                    <div>
                        <h2 style="font-size: 1.75rem; margin-bottom: 0.5rem;"><%= report.incident_type %></h2>
                        <p style="color: var(--text-muted);">
                            <i class="fas fa-calendar"></i> Submitted: <%= new Date(report.created_at).toLocaleString() %>
                        </p>
                    </div>
                    <span class="status-badge status-<%= report.status %>" style="font-size: 1rem; padding: 0.75rem 1.5rem;">
                        <% if (report.status === 'pending') { %>
                            <i class="fas fa-clock"></i>
                        <% } else if (report.status === 'review') { %>
                            <i class="fas fa-search"></i>
                        <% } else if (report.status === 'resolved') { %>
                            <i class="fas fa-check"></i>
                        <% } else if (report.status === 'rejected') { %>
                            <i class="fas fa-times"></i>
                        <% } %>
                        <%= report.status.toUpperCase() %>
                    </span>
                </div>

                <div style="border-top: 1px solid var(--border); padding-top: 2rem;">
                    <h3 style="margin-bottom: 1rem; color: var(--primary);">
                        <i class="fas fa-info-circle"></i> Incident Information
                    </h3>
                    <div style="display: grid; gap: 1rem;">
                        <% if (report.incident_date) { %>
                            <div>
                                <strong style="color: var(--text);">Incident Date:</strong>
                                <p style="color: var(--text-muted); margin-top: 0.25rem;">
                                    <%= new Date(report.incident_date).toLocaleDateString() %>
                                </p>
                            </div>
                        <% } %>
                        <% if (report.location) { %>
                            <div>
                                <strong style="color: var(--text);">Location:</strong>
                                <p style="color: var(--text-muted); margin-top: 0.25rem;">
                                    <i class="fas fa-map-marker-alt"></i> <%= report.location %>
                                </p>
                            </div>
                        <% } %>
                    </div>
                </div>

                <div style="border-top: 1px solid var(--border); padding-top: 2rem; margin-top: 2rem;">
                    <h3 style="margin-bottom: 1rem; color: var(--primary);">
                        <i class="fas fa-file-alt"></i> Description
                    </h3>
                    <p style="color: var(--text-muted); line-height: 1.8; white-space: pre-wrap;"><%= report.description %></p>
                </div>

                <% if (report.evidence_file) { %>
                    <div style="border-top: 1px solid var(--border); padding-top: 2rem; margin-top: 2rem;">
                        <h3 style="margin-bottom: 1rem; color: var(--primary);">
                            <i class="fas fa-paperclip"></i> Evidence
                        </h3>
                        <a href="/uploads/<%= report.evidence_file %>" target="_blank" class="btn btn-outline">
                            <i class="fas fa-download"></i> Download Evidence File
                        </a>
                    </div>
                <% } %>

                <% if (report.admin_response) { %>
                    <div style="border-top: 1px solid var(--border); padding-top: 2rem; margin-top: 2rem; background: rgba(99, 102, 241, 0.05); padding: 1.5rem; border-radius: 12px; margin-left: -1.5rem; margin-right: -1.5rem; padding-left: 2rem; padding-right: 2rem;">
                        <h3 style="margin-bottom: 1rem; color: var(--primary);">
                            <i class="fas fa-reply"></i> Admin Response
                        </h3>
                        <p style="color: var(--text); line-height: 1.8; white-space: pre-wrap;"><%= report.admin_response %></p>
                    </div>
                <% } %>
            </div>

            <div>
                <div class="card" style="margin-bottom: 1.5rem;">
                    <h3 style="margin-bottom: 1.5rem; color: var(--primary);">
                        <i class="fas fa-chart-line"></i> Status Timeline
                    </h3>
                    <div style="display: flex; flex-direction: column; gap: 1rem;">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div style="width: 40px; height: 40px; background: rgba(99, 102, 241, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-check" style="color: var(--primary);"></i>
                            </div>
                            <div>
                                <strong style="color: var(--text);">Submitted</strong>
                                <p style="color: var(--text-muted); font-size: 0.875rem; margin-top: 0.25rem;">
                                    <%= new Date(report.created_at).toLocaleDateString() %>
                                </p>
                            </div>
                        </div>
                        <% if (report.status !== 'pending') { %>
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <div style="width: 40px; height: 40px; background: rgba(99, 102, 241, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                    <i class="fas fa-search" style="color: var(--primary);"></i>
                                </div>
                                <div>
                                    <strong style="color: var(--text);">Under Review</strong>
                                    <p style="color: var(--text-muted); font-size: 0.875rem; margin-top: 0.25rem;">In progress</p>
                                </div>
                            </div>
                        <% } %>
                        <% if (report.status === 'resolved' || report.status === 'rejected') { %>
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <div style="width: 40px; height: 40px; background: <%= report.status === 'resolved' ? 'rgba(16, 185, 129, 0.2)' : 'rgba(239, 68, 68, 0.2)' %>; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                    <i class="fas fa-<%= report.status === 'resolved' ? 'check-circle' : 'times-circle' %>" style="color: <%= report.status === 'resolved' ? 'var(--success)' : 'var(--danger)' %>;"></i>
                                </div>
                                <div>
                                    <strong style="color: var(--text);"><%= report.status === 'resolved' ? 'Resolved' : 'Rejected' %></strong>
                                    <p style="color: var(--text-muted); font-size: 0.875rem; margin-top: 0.25rem;">
                                        <%= new Date(report.updated_at).toLocaleDateString() %>
                                    </p>
                                </div>
                            </div>
                        <% } %>
                    </div>
                </div>

                <div class="card" style="background: rgba(245, 158, 11, 0.1); border-color: var(--warning);">
                    <h3 style="margin-bottom: 1rem; color: var(--warning);">
                        <i class="fas fa-info-circle"></i> Need Help?
                    </h3>
                    <p style="color: var(--text-muted); line-height: 1.6; margin-bottom: 1rem;">
                        If you have additional information or questions about this report, please contact support.
                    </p>
                    <a href="mailto:support@cybercrime.gov" class="btn btn-outline btn-full">
                        <i class="fas fa-envelope"></i> Contact Support
                    </a>
                </div>
            </div>
        </div>
    </div>
</main>

<%- include('partials/footer') %>
