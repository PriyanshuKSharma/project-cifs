<%- include('../partials/header') %>

<main class="main-content">
    <div class="dashboard-container">
        <div class="dashboard-header">
            <h1><i class="fas fa-tachometer-alt"></i> Admin Dashboard</h1>
            <p>Cybercrime Reports Management System</p>
        </div>

        <div class="dashboard-stats">
            <div class="stat-card">
                <i class="fas fa-file-alt"></i>
                <div class="stat-info">
                    <h3><%= stats.total || 0 %></h3>
                    <p>Total Reports</p>
                </div>
            </div>
            <div class="stat-card">
                <i class="fas fa-clock"></i>
                <div class="stat-info">
                    <h3><%= stats.pending || 0 %></h3>
                    <p>Pending</p>
                </div>
            </div>
            <div class="stat-card">
                <i class="fas fa-eye"></i>
                <div class="stat-info">
                    <h3><%= stats.review || 0 %></h3>
                    <p>Under Review</p>
                </div>
            </div>
            <div class="stat-card">
                <i class="fas fa-check-circle"></i>
                <div class="stat-info">
                    <h3><%= stats.resolved || 0 %></h3>
                    <p>Resolved</p>
                </div>
            </div>
        </div>

        <div class="dashboard-actions">
            <a href="/admin/reports" class="btn btn-primary">
                <i class="fas fa-list"></i> View All Reports
            </a>
            <a href="/admin/tips" class="btn btn-secondary">
                <i class="fas fa-lightbulb"></i> Manage Tips
            </a>
        </div>

        <div class="admin-content">
            <div class="recent-reports">
                <h2>Recent Reports</h2>
                <% if (recentReports.length > 0) { %>
                    <div class="reports-list">
                        <% recentReports.forEach(function(report) { %>
                        <div class="report-item">
                            <div class="report-info">
                                <h4><%= report.incident_type %></h4>
                                <p><strong>Reporter:</strong> <%= report.user_name %> (<%= report.user_email %>)</p>
                                <p><%= report.description.substring(0, 100) %>...</p>
                                <small>
                                    <i class="fas fa-calendar"></i> <%= new Date(report.created_at).toLocaleDateString() %>
                                    | <i class="fas fa-clock"></i> Incident: <%= new Date(report.incident_date).toLocaleDateString() %>
                                </small>
                            </div>
                            <div class="report-status">
                                <span class="status-badge status-<%= report.status %>">
                                    <%= report.status.charAt(0).toUpperCase() + report.status.slice(1) %>
                                </span>
                                <a href="/admin/report/<%= report.id %>" class="btn btn-sm">
                                    <i class="fas fa-eye"></i> Review
                                </a>
                            </div>
                        </div>
                        <% }); %>
                    </div>
                    <div class="text-center">
                        <a href="/admin/reports" class="btn btn-outline">View All Reports</a>
                    </div>
                <% } else { %>
                    <div class="empty-state">
                        <i class="fas fa-inbox"></i>
                        <h3>No reports yet</h3>
                        <p>New cybercrime reports will appear here</p>
                    </div>
                <% } %>
            </div>
        </div>

        <div class="admin-stats-chart">
            <h2>Reports Overview</h2>
            <div class="chart-container">
                <div class="chart-bar">
                    <div class="bar-item">
                        <div class="bar-label">Pending</div>
                        <div class="bar-visual">
                            <div class="bar-fill pending" style="width: <%= stats.total > 0 ? (stats.pending / stats.total * 100) : 0 %>%"></div>
                        </div>
                        <div class="bar-value"><%= stats.pending || 0 %></div>
                    </div>
                    <div class="bar-item">
                        <div class="bar-label">Under Review</div>
                        <div class="bar-visual">
                            <div class="bar-fill review" style="width: <%= stats.total > 0 ? (stats.review / stats.total * 100) : 0 %>%"></div>
                        </div>
                        <div class="bar-value"><%= stats.review || 0 %></div>
                    </div>
                    <div class="bar-item">
                        <div class="bar-label">Resolved</div>
                        <div class="bar-visual">
                            <div class="bar-fill resolved" style="width: <%= stats.total > 0 ? (stats.resolved / stats.total * 100) : 0 %>%"></div>
                        </div>
                        <div class="bar-value"><%= stats.resolved || 0 %></div>
                    </div>
                    <div class="bar-item">
                        <div class="bar-label">Rejected</div>
                        <div class="bar-visual">
                            <div class="bar-fill rejected" style="width: <%= stats.total > 0 ? (stats.rejected / stats.total * 100) : 0 %>%"></div>
                        </div>
                        <div class="bar-value"><%= stats.rejected || 0 %></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<style>
.admin-content {
    margin-bottom: 3rem;
}

.admin-stats-chart {
    background: white;
    padding: 2rem;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.admin-stats-chart h2 {
    text-align: center;
    margin-bottom: 2rem;
    color: #2c3e50;
}

.chart-container {
    max-width: 600px;
    margin: 0 auto;
}

.bar-item {
    display: flex;
    align-items: center;
    margin-bottom: 1rem;
    gap: 1rem;
}

.bar-label {
    width: 100px;
    font-weight: 600;
    color: #555;
}

.bar-visual {
    flex: 1;
    height: 30px;
    background-color: #f0f0f0;
    border-radius: 15px;
    overflow: hidden;
}

.bar-fill {
    height: 100%;
    border-radius: 15px;
    transition: width 0.5s ease;
}

.bar-fill.pending {
    background-color: #f39c12;
}

.bar-fill.review {
    background-color: #3498db;
}

.bar-fill.resolved {
    background-color: #27ae60;
}

.bar-fill.rejected {
    background-color: #e74c3c;
}

.bar-value {
    width: 40px;
    text-align: center;
    font-weight: bold;
    color: #2c3e50;
}
</style>

<%- include('../partials/footer') %>